<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>H40N - N.ROOT | CONTINGENCY</title>

<style>
    body {
        background: #0a0a0a;
        margin: 0;
        padding: 0;
        font-family: monospace;
        color: #e5e5e5;
    }

    .terminal-wrapper {
        width: 90%;
        max-width: 900px;
        margin: 40px auto;
        background: #111;
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid #222;
        box-shadow: 0 8px 40px rgba(0,0,0,0.7);
    }

    .terminal-header {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: #1a1a1a;
        border-bottom: 1px solid #222;
    }

    .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }
    .red { background: #ff5f56; }
    .yellow { background: #ffbd2e; }
    .green { background: #27c93f; }

    .terminal-title {
        flex: 1;
        text-align: center;
        opacity: 0.75;
    }

    #output {
        height: 65vh;
        padding: 20px;
        overflow-y: auto;
        white-space: pre-wrap;
    }

    .terminal-input-area {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: #1a1a1a;
        border-top: 1px solid #222;
    }

    #prompt { color: #00e676; font-weight: bold; }
    #input {
        flex: 1;
        background: transparent;
        border: none;
        outline: none;
        color: #e5e5e5;
        font-size: 1rem;
    }

    .user-msg {
  color: #6ac8ff; /* azul ciano suave, legível no fundo escuro */
  }

  .admin-msg {
  color: #e5e5e5;
  font-weight: 700;
  }


    .line { margin: 5px 0; }
</style>
</head>

<body>

<div class="terminal-wrapper">
    <div class="terminal-header">
        <div class="dot red"></div>
        <div class="dot yellow"></div>
        <div class="dot green"></div>
        <div class="terminal-title">H40N - N.ROOT | CONTINGENCY</div>
    </div>

    <div id="output"></div>

    <div class="terminal-input-area">
        <div id="prompt">&gt;</div>
        <input id="input" autocomplete="off">
    </div>
</div>

<script>
/* ================================
      HISTÓRICO (persistente)
================================ */
const STORAGE_KEY = "terminal_history";
let history = [];
let historyIndex = -1;

function loadHistory() {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
        try {
            history = JSON.parse(saved);
        } catch {
            history = [];
        }
    }
}

function saveHistory() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
}

function addToHistory(text) {
    if (!text.trim()) return;
    history.push(text);
    if (history.length > 200) {
        history = history.slice(history.length - 200);
    }
    saveHistory();
}

/* ================================
      OUTPUT
================================ */
const output = document.getElementById("output");
const input = document.getElementById("input");

function appendLine(text, cls = "") {
  const el = document.createElement("div");
  el.className = "line " + cls;
  el.textContent = text;
  output.appendChild(el);
  output.scrollTop = output.scrollHeight;
  return el;
}

/* ================================
      STARTUP: mostrar histórico
================================ */
function loadHistoryIntoOutput() {
    if (history.length === 0) return;
    history.forEach(line => appendLine(line));
}

function processCommand(cmd) {

    /* ----- deletar linha ----- */
    if (cmd.startsWith("del ")) {
        let num = parseInt(cmd.replace("del ", "").trim());
        if (isNaN(num) || num < 1 || num > history.length) {
            appendLine("[system] linha inválida.");
            return;
        }
        let removed = history[num - 1];
        history.splice(num - 1, 1);
        saveHistory();

        appendLine(`[system] linha ${num} removida: ${removed}`);
        output.innerHTML = "";
        loadHistoryIntoOutput();
        return;
    }

    /* ----- admin / H40N ----- */
    if (cmd.startsWith("admin ")) {
        const clean = cmd.replace("admin ", "");
        const text = clean;
        appendLine(text, "admin-msg");
        addToHistory(text);
        return;
    }

    /* ----- user normal ----- */
    const text = "[user] " + cmd;
    appendLine(text, "user-msg");
    addToHistory(text);
}



/* ================================
      NAVEGAÇÃO COM SETAS
================================ */
input.addEventListener("keydown", (e) => {
    // ENTER
    if (e.key === "Enter") {
        const cmd = input.value.trim();
        input.value = "";
        historyIndex = -1;

        if (cmd) processCommand(cmd);
    }

    // SETA PARA CIMA
    if (e.key === "ArrowUp") {
        if (history.length > 0) {
            if (historyIndex < history.length - 1) historyIndex++;
            input.value = history[history.length - 1 - historyIndex] || "";
        }
    }

    // SETA PARA BAIXO
    if (e.key === "ArrowDown") {
        if (historyIndex > 0) {
            historyIndex--;
            input.value = history[history.length - 1 - historyIndex] || "";
        } else {
            historyIndex = -1;
            input.value = "";
        }
    }
});

/* ================================
      INIT
================================ */
loadHistory();
loadHistoryIntoOutput();
input.focus();
</script>

</body>
</html>
